<?xml version="1.0"?>

<!-- Configuration for CouetteTest.h, a configurable Couette flow test for noise-filtered multi-instance Nie coupling -->
<couette-test>
  <!-- Coupled simulation general setup parameters:
    - int coupling-cycles:
      Total number of coupling cycles to run. Each cycle may consist of e.g. 100 MD timesteps.
    - bool two-way-coupling:
      Enables / disables the use of MD data as boundary condition in LBCouetteSolver.
    - bool send-from-md-to-macro:
      Enables / disables the data transfer from MD instances, merging, and communication to macroscopic-solver ranks.
    - bool send-from-macro-to-md:
      Enables / disables data extraction from couette solver and communication to MD ranks.
    - int filter-init-cycles:
      Number of cycles with two-way-coupling and compute-snr disabled at simulation startup, used for initialisation of noise filter.
    - int write-csv-every-timestep:
      Writes data collected by sendFromMD2Macro, i.e. noise filter output, to CSV file; for evaluation.
    - bool compute-snr:
      Enables / disables computation of signal-to-noise ratio between filter output and macroscopic solver, writes to stdout.
  -->
  <coupling
    coupling-cycles="20"
    two-way-coupling="yes"
    send-from-md-to-macro="yes"
    filter-init-cycles="0"
    write-csv-every-timestep="1"
    send-from-macro-to-md="yes"
    compute-snr="no"
  />

  <!-- Configuration parameters for microscopic solver:
    - string type:
      Supports "md" (SimpleMD) or "synthetic" (data from macroscopic plus gaussian noise).
      Synthetic runs sequentially only and does not support parallel communication, so send-from-x-to-x must be "no".
      Hence, in the Synthetic + LB case, macroscopic-solver_number-of-processes must be "1 ; 1 ; 1"
      Synthetic MD does not support multi-instance sampling. 
    - md: double temperature:
      Temperature of MD system, is initially applied to the molecules using the thermostat.
    - md: int equilibration-steps
      Number of MD timesteps to run before start of coupled simulation.
      Can be 0 if MD checkpoint is used.
    - md: int number-md-simulations:
      Total number of MD instances.
      Set to 1 to disable multi-instance sampling.
    - synthetic: double noise-sigma
      Standard deviation of gaussian noise used to emulate MD flow field data, e.g. "0.1667".
    - double density:
      Density of fluid
      Should be equal to molecules-per-direction[0] / domain-size[0] * molecules-per-direction[1] / domain-size[1] * molecules-per-direction[2] / domain-size[2], unless MD checkpoint is used.
  -->
  <microscopic-solver
    type="md"
    temperature="1.1"
    equilibration-steps="0"
    number-md-simulations="100"
    density="0.81"
    noise-sigma="0.1666"
  />

  <!-- Optional feature: tws-loop
    Used to override time-window-size (tws) parameter in <mamico <noise-reduction>>
    Reruns the complete simulation for a range of time-window-size values.
    - int min:
      Starting value of tws.
    - int max:
      Loop while tws <= max.
    - optional int step:
      Increments tws by step, default 1.
    Example <tws-loop min="3" max="100" step="5" />
  -->
</couette-test>
