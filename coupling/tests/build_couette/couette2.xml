<?xml version="1.0"?>

<!-- Configuration for CouetteTest.h, a configurable Couette flow test for noise-filtered multi-instance Nie coupling -->
<couette-test>
  <!-- Simulation domain / scenario parameters:
    - double channelheight: 
      z distance between upper and lower wall (parallel plates)
      Since the domain is cubic, this determines also the domain size in x and y directions.
    - Vector<3,double> wall-velocity: 
      Speed of moving wall (for all timesteps after wall-init-cycles coupling cycles)
    - optional int wall-init-cycles: 
      Number of coupling cycles with wall-init-velocity applied instead of wall-velocity
      This can be used to investigate or initialize the simulation before the couette startup.
    - optional Vector<3,double> wall-init-velocity: 
      Speed of moving wall, for the first wall-init-cycles simulation cycles
      Should be "0.0 ; 0.0 ; 0.0" unless e.g multi-stage startup is desired.
    - optional double wall-oscillations: 
      To create oscillating couette scenario, define the total number of periods during all coupling cycles here. 
      For every CYCLE after wall-init-cycles, wall speed will equal:
        wall-velocity * cos(2PI * wall-oscillations * CYCLE / coupling-cycles)
  -->
  <domain
    channelheight="50"
    wall-velocity="0.5 ; 0.0 ; 0.0"
    wall-oscillations="4.775"
  />

  <!-- Optional feature: tws-loop
    Used to override time-window-size (tws) parameter in <mamico <noise-reduction>>
    Reruns the complete simulation for a range of time-window-size values.
    - int min:
      Starting value of tws.
    - int max:
      Loop while tws <= max.
    - optional int step:
      Increments tws by step, default 1.
    Example <tws-loop min="3" max="100" step="5" />
  -->
  <tws-loop min="3" max="100" step="5" />

  <!-- Coupled simulation general setup parameters:
    - int coupling-cycles:
      Total number of coupling cycles to run. Each cycle may consist of e.g. 100 MD timesteps.
    - bool two-way-coupling:
      Enables / disables the use of MD data as boundary condition in LBCouetteSolver.
    - bool send-from-md-to-macro:
      Enables / disables the data transfer from MD instances, merging, and communication to macroscopic-solver ranks.
    - bool send-from-macro-to-md:
      Enables / disables data extraction from couette solver and sending to MD.
    - int filter-init-cycles:
      Number of cycles with two-way-coupling and compute-snr disabled at simulation startup, used for initialisation of noise filter.
    - int write-csv-every-timestep:
      Writes data collected by sendFromMD2Macro, i.e. noise filter output, to CSV file; for evaluation.
    - bool compute-snr:
      Enables / disables computation of signal-to-noise ratio between filter output and macroscopic solver, writes to stdout.
  -->
  <coupling
    coupling-cycles="1100"
    two-way-coupling="no"
    send-from-md-to-macro="no"
    filter-init-cycles="100"
    write-csv-every-timestep="0"
    send-from-macro-to-md="no"
    compute-snr="yes"
  />

  <!-- Configuration parameters for macroscopic solver:
    - string type:
      Supports "lb" (Lattice Boltzmann solver) or "analytical".
      Note that analytic solver only supports flow in x-direction, is only active on rank 0, 
      and that it does not model viscous shear forces in the oscillating wall case (i.e. changes of wall-velocity are propagated through the whole domain instantaneously).
      The LB solver does not impose these limitations and can be parallelized.
    - lb: Vector<3,unsigned int> number-of-processes:
      Number of LB ranks per direction (x; y; z)
    - lb: int plot-every-timestep:
      VTK plotting per time step
    - double viscosity:
      Dynamic viscosity of fluid
    - int init-advance-cycles:
      Advances the macroscopic-solver before starting the coupling. Can be used for analytic solver and oscillating wall, 
      to skip couette startup.
  -->
  <macroscopic-solver 
    type="analytical"
    viscosity="2.14"
    init-advance-cycles="10000000"
  />

  <!-- Configuration parameters for microscopic solver:
    - string type:
      Supports "md" (SimpleMD) or "synthetic" (data from macroscopic plus gaussian noise).
    - md: double temperature:
      Temperature of MD system, is initially applied to the molecules using the thermostat.
    - md: int equilibration-steps
      Number of MD timesteps to run before start of coupled simulation.
      Can be 0 if MD checkpoint is used.
    - md: int number-md-simulations:
      Total number of MD instances.
      Set to 1 to disable multi-instance sampling.
    - synthetic: double noise-sigma
      Standard deviation of gaussian noise used to emulate MD flow field data, e.g. "0.1667".
    - double density:
      Density of fluid
      Should be equal to molecules-per-direction[0] / domain-size[0] * molecules-per-direction[1] / domain-size[1] * molecules-per-direction[2] / domain-size[2], unless MD checkpoint is used.
  -->
  <microscopic-solver
    type="synthetic"
    noise-sigma="0.1667"
    density="0.813037037"
  />
</couette-test>
